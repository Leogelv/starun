# Краткосрочный план по интеграции Supabase

## Логические основания
- **Вещь**: Интеграция Supabase в React Telegram Mini App.
- **Свойства**: 
    - Получение данных пользователя Telegram.
    - "Аутентификация" пользователя в Supabase (создание/обновление записи).
    - Отображение данных пользователя из Supabase на `IndexPage`.
    - Отображение всех пользователей из таблицы `public.users` на `IndexPage`.
    - Проверка окружения (Telegram vs. браузер) с возможностью отключения.
- **Отношения**: 
    - Клиент Supabase взаимодействует с API Supabase.
    - `IndexPage` отображает данные, полученные через клиент Supabase.
    - Логика "аутентификации" использует `initData` от Telegram SDK.

## Задачи:
1.  [x] Проверить существование таблицы `users` в схеме `public` через MCP Supabase.
2.  [x] Создать клиент Supabase (`src/lib/supabase/client.ts`).
3.  [x] Реализовать логику "регистрации/входа" пользователя:
    *   [x] Функция для проверки/создания/обновления пользователя в Supabase на основе Telegram `initData`.
4.  [x] Интегрировать в `IndexPage.tsx`:
    *   [x] Получение и отображение данных текущего пользователя из Supabase.
    *   [x] Отображение статуса подключения к Supabase.
    *   [x] Получение и отображение списка всех пользователей из `public.users`.
5.  [x] Реализовать проверку окружения (Telegram App vs Browser) с возможностью отключения через ENV.
6.  [x] Обновить `architecture.md`.
7.  [x] Протестировать.
8.  [ ] Сделать коммит и пуш.

## Чек-лист проверок:
- [x] Навигация: Не затронута.
- [x] Консистентность флоу: Проверить, что данные пользователя из Telegram корректно передаются и используются для Supabase.
- [x] Читаемость кода: Код должен быть понятен, с комментариями на русском.
- [x] Обработка ошибок: Предусмотреть базовую обработку ошибок при взаимодействии с Supabase.
- [x] Соответствие ТЗ: Все пункты из запроса пользователя учтены.
- [x] Лимиты на размер файла: Соблюдены.
- [x] .env переменные: используются корректно (NEXT_PUBLIC_).
- [x] RLS: Убедиться, что RLS для public.users временно отключен (пользователь подтвердил). 